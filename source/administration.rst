Руководство администратора по работе с кластером
================================================
В руководстве приведены сведения для администраторов системы по работе с кластером, с пользователями и группами пользователей кластера. 

Руководство может быть полезно администраторам, программистам, разработчикам и сотрудникам подразделений информационных технологий, осуществляющих сопровождение кластера.


Контактная информация службы поддержки:

E-mail: info@arenadata.io



.. toctree::
   :maxdepth: 2
   :caption: Оглавление:

   

Аннотация
---------

**Apache Ambari** – это система, которая помогает в управлении и контролировании кластеров **Hadoop**. Данное руководство предназначено для системных администраторов, ответственных за установку и обслуживание кластеров **Ambari** и **Hadoop**, управляемых **Ambari**. 

При установке **Ambari** по умолчанию создается пользователь с правами администратора со следующими параметрами:

+ Имя пользователя: *admin*;
+ Пароль: *admin*.

При авторизации в системе администратору **Ambari** доступны следующие функции:

+	Управление учетной записью администратора Ambari;
+	Управление кластером;
+	Управление пользователями и группами пользователей.


Учетаная запись администратора Ambari
-------------------------------------

Авторизация в Ambari
^^^^^^^^^^^^^^^^^^^^


После установки **Ambari** (см.  «Инструкция по установке кластера») для входа в систему необходимо ввести в веб-браузер следующий URL-адрес:

    :command:`http://<your.ambari.server>:8080`

Где указываются параметры:

+	*<your.ambari.server>* – имя хоста установленного сервера Ambari; 
+	*8080* – HTTP-порт по умолчанию. 


Далее следует ввести учетные данные администратора **Ambari**, созданного автоматически во время установки кластера:

+	Имя пользователя: *admin*;
+	Пароль: *admin*.

При корректном вводе данных открывается главная страница **Ambari**, на которой отображаются компоненты **Ambari** и их метрики. 

.. _admin-img-1:

.. figure:: imgs/admin_pic.1.*
   :align: center
   
   Рис.1. Главная страница Ambari


Экран настроек Ambari
^^^^^^^^^^^^^^^^^^^^^


Для перехода на экран настроек **Ambari** необходимо на главной странице перейти по пунктам меню панели управления "admin – Manage Ambari" (см. :ref:`Рис.1.<admin-img-1>`). При этом открывается экран настроек **Ambari** (:ref:`Рис.2.<admin-img-2>`).

.. _admin-img-2:

.. figure:: imgs/admin_pic.2.*
   :align: center
   
   Рис.2. Экран настроек Ambari

Экран настроек **Ambari** состоит из панелей управления "Clusters", "Views" и "User + Group Management".

Панель "Clusters" отображает ссылки на имеющиеся кластеры и позволяет управлять их правами доступа.
Панель "Views" позволяет создавать и редактировать представления системы и управлять правами доступа для этих представлений. 
Панель "User + Group Management" позволяет управлять, создавать и редактировать пользователей и группы пользователей.


Изменение пароля учетной записи администратора
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Во время установки и настройки кластера мастер установки автоматически создает пользователя с правами администратора **Ambari**. Для данного пользователя рекомендуется сменить пароль, заданный по умолчанию. Для этого на экране настроек **Ambari** необходимо (см. :ref:`Рис.2.<admin-img-2>`):

+	В блоке "User + Group Management" перейти по ссылке "Users" и выбрать пользователя *admin*. При этом отображается окно параметров администратора (см. :ref:`Рис.3.<admin-img-3>`);
+	В поле "Password" нажать кнопку *Change Password*;
+	В открывшемся диалоговом окне ввести текущий пароль администратора и дважды указать новый пароль;
+	Нажать кнопку *ОК* для сохранения нового пароля.

.. _admin-img-3:

.. figure:: imgs/admin_pic.3.*
   :align: center
   
   Рис.3. Параментры администратора


Кластер
-------

Права доступа
^^^^^^^^^^^^^

В **Ambari** есть два типа прав доступа к кластеру: "Operator" и "Read-Only". 

После создания кластера администраторы **Ambari** автоматически получают право доступа "Operator". По умолчанию другие пользователи не имеют доступа к кластеру. Права доступа к кластеру для пользователей и групп пользователей назначаются администратором в экране настроек **Ambari** (см. :ref:`Рис.2.<admin-img-2>`).

Пользователям и группам пользователей с правом "Operator" предоставляется доступ к кластеру и обеспечивается полный контроль над следующими функциями кластера:

+	Запуск;
+	Остановка;
+	Перезапуск;
+	Создание нового.

Право доступа "Operator" обеспечивает полный контроль над следующими конфигурациями кластера:

+	Изменение;
+	Возврат.

Пользователям и группам пользователей с правом "Read-Only" предоставляется доступ только к просмотру кластера. 

Для изменения прав доступа к кластеру для пользователей и групп пользователей администратору **Ambari** необходимо выполнить следующие действия:

+	На панели "Clusters" в экране настроек Ambari нажать кнопку *Permissions*. При этом отображается табличная форма с правами доступа "Operator" и "Read-Only" с возможностью назначения их пользователям и группам пользователей (см. :ref:`Рис.4.<admin-img-4>`);
+	Для назначения прав необходимо в блоках "Grant permissions to these users" и "Grant permissions to these groups" указать соответствующих пользователей и группы, нажав кнопку *Add User* или *Add Group*; 
+	Для снятия прав с пользователей или групп необходимо нажать значок *X*, расположенный рядом с именем пользователя или названием группы;
+	Для сохранения изменений нажать кнопку с пиктограммой галочки.

.. _admin-img-4:

.. figure:: imgs/admin_pic.4.*
   :align: center
   
   Рис.4. Права доступа к кластеру

Для группы без пользователей так же возможна установка прав.

.. important:: Необходимо проверить наличие прав доступа у каждого пользователя, каждой группы и каждого пользователя в группе, чтобы убедиться, что у всех  есть соответствующие разрешения

Дополнительные сведения об управлении пользователями и группами пользователей приведены в разделе "Пользователи и группы пользователей".


Переименование кластера
^^^^^^^^^^^^^^^^^^^^^^^

Для изменения названия кластера необходимо на панели "Clusters" кликнуть по значку *Rename Cluster* (:ref:`Рис.5.<admin-img-5>`).

.. _admin-img-5:

.. figure:: imgs/admin_pic.5.*
   :align: center
   
   Рис.5. Значок «Rename Cluster»

При этом название кластера становится доступным для редактирования. Необходимо вручную ввести новое название кластера, нажать галочку и подтвердить действие.

.. important:: Чтобы изменения вступили в силу, необходимо перезапустить Ambari Server и Ambari Agents

При смене названия кластера также меняется ресурс **REST API**.

.. important:: Для использования кластера с новым названием необходимо настроить все применимые API


Переход на главный экран Ambari
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Для возвращения на главный экран **Ambari** необходимо на панели "Clusters" нажать кнопку *Go to Dashboard* (см. :ref:`Рис.2.<admin-img-2>`). При этом происходит переход на главный экран **Ambari** (см. :ref:`Рис.1.<admin-img-1>`).



Пользователи и группы пользователей
-----------------------------------

Администратор **Ambari** может создавать и управлять пользователями и группами пользователей, доступными для **Ambari**. **Ambari** поддерживает два типа пользователей и групп: локальные и LDAP:

+	Типы пользователей и групп: локальные и LDAP;
+	Права администратора Ambari.

Администратор **Ambari** может импортировать информацию о пользователе и группе пользователей в **Ambari** из внешних систем **LDAP**.
В разделе описываются задачи, выполняемые при управлении пользователями и группами пользователей в **Ambari**:

+	Создание локального пользователя;
+	Настройка статуса пользователя;
+	Установка права администратора Ambari;
+	Изменение пароля локального пользователя;
+	Удаление локального пользователя;
+	Создание локальной группы;
+	Управление пользователями в группах;
+	Удаление локальной группы.


Типы пользователей и групп: локальные и LDAP
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Ambari** поддерживает два типа пользователей и групп: локальные и LDAP.

Локальные пользователи хранятся и аутентифицируются в базе данных **Ambari**. Пользователи LDAP имеют базовую информацию учетной записи, хранящуюся в базе данных **Ambari**. В отличие от локальных пользователей, пользователи LDAP аутентифицируются по внешней системе **LDAP**.

Локальные группы хранятся в базе данных **Ambari**. Группы LDAP имеют базовую информацию, хранящуюся в базе данных **Ambari**, включая информацию о пользователях в группе. В отличие от локальных групп, группы LDAP импортируются и синхронизируются из внешней системы **LDAP**.

Чтобы использовать пользователей и группы LDAP с **Ambari**, необходимо настроить **Ambari** для аутентификации с внешней системой **LDAP**.

Новый пользователь или группа пользователей **Ambari**, созданный либо локально, либо путем синхронизации с **LDAP**, по умолчанию не получает никаких прав. Администратору **Ambari** необходимо предоставлять каждому пользователю права на доступ к кластерам.


Права администратора Ambari
^^^^^^^^^^^^^^^^^^^^^^^^^^^














