Secondary NameNode
===================

NameNode хранит изменения в файловой системе в виде журнала правок, добавляемого к родному файлу. Когда NameNode запускается, он читает состояние **HDFS** из файла изображения, fsimage, а затем применяет изменения из файла журнала. После чего он записывает новое состояние **HDFS** в fsimage и начинает обычную работу с пустым файлом правок. Поскольку NameNode объединяет fsimage и редактирует файлы только во время запуска, файл журнала правок может со временем стать очень большим на занятом кластере. Другим побочным эффектом большего файла журнала правок является то, что следующий перезапуск NameNode занимает больше времени.

В свою очередь Secondary NameNode время от времени объединяет файлы журнала правок с fsimage и сохраняет размер журнала в пределах лимита. Поскольку требования к памяти у вторичного и основного NameNode одинаковы, Secondary NameNode обычно запускается на другом компьютере, чем  NameNode.

Запуск процесса контрольной точки на Secondary NameNode управляется двумя параметрами конфигурации:

* ``dfs.namenode.checkpoint.period`` -- по умолчанию установлено значение на 1 час; определяет максимальную задержку между двумя последовательными контрольными точками; 

* ``dfs.namenode.checkpoint.txns`` -- по умолчанию установлено значение на 1 миллион; определяет количество незарегистрированных транзакций на NameNode, которые будут вызывать срочную контрольную точку, даже если период ее не был достигнут.

Secondary NameNode хранит последнюю контрольную точку в каталоге, который структурирован таким же образом, как и каталог основного NameNode. Таким образом изображение с контрольной точкой всегда готово к считыванию основным NameNode при необходимости.

