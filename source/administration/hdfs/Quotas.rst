Квоты
========


Name Quotas
Space Quotas
Storage Type Quotas
Administrative Commands
Reporting Command

Квоты имен
Квоты пространств
Квоты хранения
Административные команды
Отчетная команда

Распределенная файловая система **Hadoop** (**HDFS**) позволяет администратору устанавливать квоты на количество используемых имен и объем пространства для отдельных каталогов. Квоты имен и квоты пространства работают независимо, но администрирование и реализация этих двух типов квот тесно параллельны.

Квоты имен
------------

Квота имен -- это жесткое ограничение на количество имен файлов и каталогов в root-дереве директории со следующими правилами:

+ Создание файлов и каталогов завершается ошибкой в случае превышения квоты;
+ Квоты придерживаются переименованных каталогов, но операция переименования не может быть выполнена в случае, если она приводит к нарушению квоты;
+ Попытка установить квоту будет успешной, даже если каталог нарушает эту новую квоту;
+ Новая созданная директория не имеет связанных квот;
+ Самая большая квота -- ``Long.Max_Value``. Установленное значение квоты в *1* заставляет каталог оставаться пустым (получается, сам каталог учитывается квотой).

Квоты постоянны благодаря *fsimage*. При запуске, если *fsimage* нарушает квоту (возможно, при скрытном изменении *fsimage*), выдается предупреждение для каждого из таких нарушений. Установка или удаление квоты создает запись в журнале.


Квоты пространств
-------------------

Квота пространств -- это жесткое ограничение на количество байтов, используемых файлами в root-дереве директории со следующими правилами:

+ Аллокация блоков не выполняется, если квота не позволяет записать полный блок;
+ Каждая реплика блока подсчитывается по квоте;
+ Квоты придерживаются переименованных каталогов, но операция переименования не может быть выполнена в случае, если она приводит к нарушению квоты;
+ Новая созданная директория не имеет связанных квот;
+ Самая большая квота -- ``Long.Max_Value``. Нулевая квота по-прежнему позволяет создавать файлы, но в них не могут быть добавлены блоки;
+ Каталоги не используют пространство файловой системы хоста и не учитывают квоту пространства;
+ Пространство файловой системы хоста, используемое для сохранения метаданных файла, не учитывается в квоте;
+ Квоты начисляются с предполагаемым коэффициентом репликации для файла, при этом изменение коэффициента репликации для файла приводит к кредитным или дебетовым квотам.


The space quota is a hard limit on the number of bytes used by files in the tree rooted at that directory. Block allocations fail if the quota would not allow a full block to be written. Each replica of a block counts against the quota. Quotas stick with renamed directories; the rename operation fails if the operation would result in a quota violation. A newly created directory has no associated quota. The largest quota is Long.Max_Value. A quota of zero still permits files to be created, but no blocks can be added to the files. Directories don’t use host file system space and don’t count against the space quota. The host file system space used to save the file meta data is not counted against the quota. Quotas are charged at the intended replication factor for the file; changing the replication factor for a file will credit or debit quotas.




