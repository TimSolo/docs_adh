Пользователи и группы пользователей
-----------------------------------

Администратор **Ambari** может создавать и управлять пользователями и группами пользователей, доступными для **Ambari**. **Ambari** поддерживает два типа пользователей и групп: локальные и LDAP:

+	Типы пользователей и групп: локальные и LDAP;
+	Права администратора Ambari.

Администратор **Ambari** может импортировать информацию о пользователе и группе пользователей в **Ambari** из внешних систем **LDAP**.
В разделе описываются задачи, выполняемые при управлении пользователями и группами пользователей в **Ambari**:

+	Создание локального пользователя;
+	Настройка статуса пользователя;
+	Установка права администратора Ambari;
+	Изменение пароля локального пользователя;
+	Удаление локального пользователя;
+	Создание локальной группы;
+	Управление пользователями в группах;
+	Удаление локальной группы.


Типы пользователей и групп: локальные и LDAP
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Ambari** поддерживает два типа пользователей и групп: локальные и LDAP.

Локальные пользователи хранятся и аутентифицируются в базе данных **Ambari**. Пользователи LDAP имеют базовую информацию учетной записи, хранящуюся в базе данных **Ambari**. В отличие от локальных пользователей, пользователи LDAP аутентифицируются по внешней системе **LDAP**.

Локальные группы хранятся в базе данных **Ambari**. Группы LDAP имеют базовую информацию, хранящуюся в базе данных **Ambari**, включая информацию о пользователях в группе. В отличие от локальных групп, группы LDAP импортируются и синхронизируются из внешней системы **LDAP**.

Чтобы использовать пользователей и группы LDAP с **Ambari**, необходимо настроить **Ambari** для аутентификации с внешней системой **LDAP**.

Новый пользователь или группа пользователей **Ambari**, созданный либо локально, либо путем синхронизации с **LDAP**, по умолчанию не получает никаких прав. Администратору **Ambari** необходимо предоставлять каждому пользователю права на доступ к кластерам.


Права администратора Ambari
^^^^^^^^^^^^^^^^^^^^^^^^^^^

Администратор **Ambari** может создавать новых пользователей, удалять пользователей, изменять их пароли и редактировать настройки. Так же можно управлять определенными привилегиями для локальных и LDAP пользователей. В таблице перечислены доступные администратору **Ambari** права для локальных и LDAP пользователей.


.. csv-table:: Доступные администратору права для локальных и LDAP пользователей
   :header: "Права администратора Ambari", "Локальный пользователь", "Пользователь LDAP"
   :widths: 20, 20, 20

   "Смена пароля", "Доступно", "Недоступно"
   "Установка пользователю права
   администратора Ambari", "Доступно", "Доступно"
   "Управление количеством 
   пользователей в группе", "Доступно", "Недоступно"
   "Удаление пользователя", "Доступно", "Недоступно"
   "Управление статусом пользователя", "Доступно", "Доступно"


Создание локального пользователя
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Для создания локального пользователя администратору **Ambari** необходимо:

+	В блоке "User + Group Management" перейти по ссылке "Users" (см. :ref:`Рис.2.<admin-img-2>`). При этом открывается окно с перечнем пользователей Ambari (:ref:`Рис.6.<admin-img-6>`); 


.. _admin-img-6:

.. figure:: imgs/admin_pic.6.*
   :align: center
   
   Рис.6. Пользователи Ambari


+	Нажать кнопку *Create Local User*. При этом открывается окно создания локального пользователя (см. :ref:`Рис.7.<admin-img-7>`);
+	В поле "Username" ввести уникальное имя пользователя (все имена пользователей автоматически преобразуются в нижний регистр);
+	В поле "Password" ввести пароль и подтвердить его;
+	Нажать кнопку *Save*.


.. _admin-img-7:

.. figure:: imgs/admin_pic.7.*
   :align: center
   
   Рис.7. Создание локального пользователя


Настройка статуса пользователя
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

У каждого пользователя **Ambari** есть статус, который может принимать следующие значения:

+	*Active* – пользователь активен и ему разрешено входить в Ambari;
+	*Inactive* – пользователь неактивен и лишен возможности входа в систему.

Установив флаг состояния как активный или неактивный, администратор может подключать или отключать доступ учетной записи пользователя к **Ambari**, сохраняя при этом информацию об учетной записи и о правах пользователя.

Для установки пользователю статуса необходимо, чтобы администратор **Ambari** выполнил следующие действия: 

+	В окне пользователей выбрать необходимого для изменения пользователя Ambari (см. :ref:`Рис.6.<admin-img-6>`). При этом открывается окно параметров пользователя (см. :ref:`Рис.8.<admin-img-8>`);
+	В поле "Status" установить флаг в положение *Active* или *Inactive*;
+	Нажать кнопку *OK* для подтверждения изменения. Изменение фиксируется незамедлительно.

.. _admin-img-8:

.. figure:: imgs/admin_pic.8.*
   :align: center
   
   Рис.8. Параметры пользователя


Установка права администратора Ambari
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Одному или нескольким пользователям системы можно установить права администратора **Ambari**. Для этого администратору **Ambari** необходимо в окне параметров требуемого пользователя в поле "Ambari Admin" установить флаг в положение *Yes* для установки пользователю прав администратора или установить флаг в положение *No* для снятия привилегии у данного пользователя (см. :ref:`Рис.8.<admin-img-8>`).

.. important:: Для предотвращения случайной блокировки прав администратора у самого администратора Ambari, снятие флага администратора у данной учетной записи невозможно


Изменение пароля локального пользователя
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Администратор **Ambari** может менять пароли локальных пользователей системы.

.. important:: Пароли LDAP не управляются Ambari и не могут быть изменены с Ambari, поскольку пользователи LDAP аутентифицируются по внешнему LDAP

Для изменения пароля локального пользователя администратору **Ambari** необходимо в окне параметров пользователя в поле "Password" нажать кнопку *Change password* и ввести пароль администратора для подтверждения наличия прав на смену пароля пользователю (см. :ref:`Рис.8.<admin-img-8>`). Далее следует ввести новый пароль для локального пользователя, подтвердить его и нажать кнопку *Save*. 


Удаление локального пользователя
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. important:: Удаление локального пользователя полностью удаляет учетную запись пользователя из системы, включая все связанные с ним права

Для удаления локального пользователя администратору **Ambari** необходимо в окне параметров требуемого пользователя нажать кнопку *Delete User* и подтвердить действие (см. :ref:`Рис.8.<admin-img-8>`).

После удаления локального пользователя можно повторно использовать имя удаленного пользователя. 

.. important:: С целью предотвращения входа в систему конкретного локального пользователя можно установить ему статус *"Inactive"* 


Создание локальной группы
^^^^^^^^^^^^^^^^^^^^^^^^^

Для создания локальной группы администратору **Ambari** необходимо выполнить следующие действия:

+	В блоке "User + Group Management" перейти по ссылке "Groups" (см. :ref:`Рис.2.<admin-img-2>`). При этом открывается окно групп пользователей (см. :ref:`Рис.9.<admin-img-9>`);
+	Нажать кнопку *Create Local Group*;
+	Ввести уникальное название группы пользователей;
+	Нажать кнопку *Save*. 


.. _admin-img-9:

.. figure:: imgs/admin_pic.9.*
   :align: center
   
   Рис.9. Группы пользователей


Управление пользователями в группах
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Администратор **Ambari** может управлять составом групп пользователей, добавляя или удаляя пользователей. Для этого необходимо в окне со списком групп пользователей выбрать необходимую для изменения группу (см. :ref:`Рис.9.<admin-img-9>`). При этом открывается окно параметров группы пользователей (:ref:`Рис.10.<admin-img-10>`).


.. _admin-img-10:

.. figure:: imgs/admin_pic.10.*
   :align: center
   
   Рис.10. Параметры группы пользователей


Для добавления локального пользователя в группу необходимо в поле "Local Members" в ячейку "New" ввести имя пользователя, которого необходимо добавить в группу. Для сохранения изменений нажать кнопку с пиктограммой галочки.

Для удаления локального пользователя из группы необходимо в поле "Local Members" нажать значок "X", расположенный рядом с именем пользователя, которого необходимо исключить из группы. Для сохранения изменений нажать кнопку с пиктограммой галочки. 



Удаление локальной группы
^^^^^^^^^^^^^^^^^^^^^^^^^

.. important:: Удаление локальной группы приводит к удалению всех прав, связанных с группой

Для удаления локальной группы администратору **Ambari** необходимо в окне параметров группы пользователей нажать кнопку "Delete Group" и подтвердить действие (см. :ref:`Рис.10.<admin-img-10>`). При этом группа и соответствующая информация о ее пользователях удаляется.
